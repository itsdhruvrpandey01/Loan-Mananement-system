<div class="container">
  <h2>Loan Applications</h2>

  <!-- Messages -->
  <div *ngIf="successMessage" class="alert success">{{ successMessage }}</div>
  <div *ngIf="errorMessage" class="alert error">{{ errorMessage }}</div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <p>Loading loan applications...</p>
  </div>

  <!-- No Loans -->
  <div *ngIf="!loading && requestedLoans.length === 0" class="no-data">
    <p>No loan applications assigned to you.</p>
  </div>

  <!-- Table -->
  <div *ngIf="!loading && requestedLoans.length > 0" class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Application ID</th>
          <th>Customer Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Amount</th>
          <th>Tenure</th>
          <th>Total Amount</th>
          <th>Status</th>
          <th>Applied On</th>
          <th>Missing Docs</th> <!-- ‚úÖ new column -->
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let loan of requestedLoans">
          <td>{{ loan.applicationId.substring(0, 8) }}...</td>
          <td>{{ loan.customerName }}</td>
          <td>{{ loan.customerEmail }}</td>
          <td>{{ loan.customerMobileNumber }}</td>
          <td>‚Çπ{{ loan.requestedAmount | number:'1.2-2' }}</td>
          <td>{{ loan.requestedTenure }} months</td>
          <td>‚Çπ{{ loan.totalLoanAmount | number:'1.2-2' }}</td>
          <td>
            <span [class]="'status-' + loan.status.toLowerCase()">
              {{ loan.status }}
            </span>
          </td>
          <td>{{ loan.createdAt | date:'dd/MM/yyyy' }}</td>

          <!-- ‚úÖ Just show button or count -->
          <td>
            <button (click)="viewMissingDocuments(loan.applicationId)" class="btn-info">
              View
            </button>
          </td>

          <!-- Actions -->
          <td class="actions">
            <button (click)="viewApplication(loan)" class="btn-view">
              üëÅ View Application
            </button>
            <button *ngIf="isPending(loan.status)" (click)="approveLoan(loan.applicationId)" class="btn-approve">
              ‚úì Approve
            </button>
            <button *ngIf="isPending(loan.status)" (click)="rejectLoan(loan.applicationId)" class="btn-reject">
              ‚úó Reject
            </button>
            <span *ngIf="!isPending(loan.status)" class="completed">
              {{ loan.status }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>